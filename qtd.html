<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Capturar Age da Transação Mais Recente</title>
</head>
<body>
  <h1>Age da Transação Mais Recente</h1>
  <p id="age">Carregando...</p>

  <script>
    // Endpoint AJAX que BscScan usa para carregar as transações (página 1)
    // Ajuste conforme necessário (contractAddress, a, p, etc.).
    const realUrl = 
      'https://bscscan.com/token/generic-token-transfers2'
      + '?contractAddress=0x893535ED1b5C6969E62a10bABfED4F5fF8373278'
      + '&mode='
      + '&a=0x000000000000000000000000000000000000dead'
      + '&sid='
      + '&p=1';

    // Usamos o proxy do cors-anywhere
    const proxyUrl = 'https://cors-anywhere.herokuapp.com/';
    const fetchUrl = proxyUrl + realUrl;

    fetch(fetchUrl)
      .then(response => {
        if (!response.ok) {
          throw new Error('Erro HTTP: ' + response.status);
        }
        return response.text();
      })
      .then(html => {
        // Cria um DOM virtual para analisar o HTML da TABELA retornada
        const parser = new DOMParser();
        const doc = parser.parseFromString(html, 'text/html');

        // A tabela costuma ter a classe "table-hover"
        // e a primeira linha do <tbody> representa a transação mais recente.
        const rows = doc.querySelectorAll('table.table-hover tbody tr');
        if (rows.length === 0) {
          document.getElementById('age').innerText =
            'Nenhuma transação encontrada (ou estrutura diferente).';
          return;
        }

        // Pega a primeira linha (mais recente)
        const firstRow = rows[0];
        const cells = firstRow.querySelectorAll('td');
        // Geralmente a ordem é:
        // 0: Txn Hash
        // 1: Method
        // 2: Block
        // 3: Age
        // 4: From
        // 5: Out
        // 6: To
        // 7: Value
        // 8: Token
        // Ajuste se estiver em outra coluna.
        const ageCell = cells[3];
        if (!ageCell) {
          document.getElementById('age').innerText =
            'Coluna "Age" não encontrada na primeira linha.';
          return;
        }

        const ageText = ageCell.innerText.trim();
        document.getElementById('age').innerText = ageText;
      })
      .catch(error => {
        document.getElementById('age').innerText = "Erro: " + error;
      });
  </script>
</body>
</html>
