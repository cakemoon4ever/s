<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Última Transação</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 2rem;
      line-height: 1.6;
    }
    .error {
      color: red;
    }
  </style>
</head>
<body>
  <h1>Última Transação</h1>
  <p>Buscando a última transação do contrato na carteira <code>dead</code>...</p>
  <div id="result"></div>

  <script>
    document.addEventListener("DOMContentLoaded", function() {
      // Exemplo usando o 'thingproxy' (pode variar conforme disponibilidade)
      const proxyUrl = "https://thingproxy.freeboard.io/fetch/";
      const targetUrl = "https://bscscan.com/token/0x893535ED1b5C6969E62a10bABfED4F5fF8373278?a=0x000000000000000000000000000000000000dEaD";
      
      fetch(proxyUrl + targetUrl)
        .then(response => {
          if (!response.ok) {
            throw new Error("Erro na requisição: " + response.status);
          }
          return response.text();
        })
        .then(htmlString => {
          // Converter o HTML retornado em um objeto DOM
          const parser = new DOMParser();
          const doc = parser.parseFromString(htmlString, "text/html");
          
          // Localiza a tabela de transações (buscando o primeiro <tbody> encontrado)
          const tbody = doc.querySelector("table tbody");
          if (!tbody) {
            throw new Error("Tabela de transações não encontrada.");
          }
          
          // Seleciona a primeira linha (transação mais recente)
          const firstRow = tbody.querySelector("tr");
          if (!firstRow) {
            throw new Error("Nenhuma transação encontrada.");
          }
          
          // (1) Extrai o Transaction Hash (buscando o link cujo href inicia com "/tx/")
          const hashLink = firstRow.querySelector('a[href^="/tx/"]');
          if (!hashLink) {
            throw new Error("Transaction hash não encontrada.");
          }
          const transactionHash = hashLink.textContent.trim();
          
          // (2) Extrai a Data completa da transação (opcional, se quiser)
          //    Normalmente está em .showDate ou atributo data-bs-title
          let dateElement = firstRow.querySelector(".showDate span[data-bs-title]");
          let transactionDate = "";
          if (dateElement) {
            transactionDate = dateElement.getAttribute("data-bs-title").trim();
          } else {
            dateElement = firstRow.querySelector(".showDate span");
            if (dateElement) {
              transactionDate = dateElement.textContent.trim();
            } else {
              transactionDate = "Data da transação não encontrada.";
            }
          }

          // (3) Extrai o texto da coluna "Age" (ex.: "452 days ago")
          //    Geralmente, a coluna "Age" é a 4ª coluna <td> da <tr>.
          const ageCell = firstRow.querySelector("td:nth-child(4)");
          if (!ageCell) {
            throw new Error("Coluna de 'Age' não encontrada.");
          }
          const ageText = ageCell.textContent.trim(); // Ex.: "452 days ago"

          // Exibe os dados extraídos na página
          document.getElementById("result").innerHTML = `
            <p><strong>Transaction Hash:</strong> ${transactionHash}</p>
            <p><strong>Data da Transação (Tooltip):</strong> ${transactionDate}</p>
            <p><strong>Age (Coluna 'Age'):</strong> ${ageText}</p>
          `;
        })
        .catch(error => {
          // Em caso de erro, exibe a mensagem apropriada
          document.getElementById("result").innerHTML = `<p class="error">Erro: ${error.message}</p>`;
        });
    });
  </script>
</body>
</html>
